@{
    ViewData["Title"] = "Heikin-Ashi candlestick";
}

<div class="text-center">
    <h5 class="display-4">Python Script Input</h5>
    <pre>@ViewBag.PythonOutput</pre>
</div>
<form asp-action="ProcessHeikin_AshiInputs" method="post" onsubmit="return validateDates()">
    <div class="mb-3">
        <label for="ticker" class="form-label">Stock Ticker</label>
        <input type="text" class="form-control" id="ticker" name="ticker" placeholder="Enter stock ticker (e.g., NVDA)">
    </div>
    <div class="mb-3">
        <label for="stdate" class="form-label">Start Date</label>
        <input type="date" class="form-control" id="stdate" name="stdate" placeholder="Enter start date (e.g., 2022-01-01)">
    </div>
    <div class="mb-3">
        <label for="eddate" class="form-label">End Date</label>
        <input type="date" class="form-control" id="eddate" name="eddate" placeholder="Enter end date (e.g., 2022-12-31)">
    </div>

    <button type="submit" class="btn btn-primary" onclick="console.log('-------Form submitted---------');">Submit</button>
</form>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Error</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                開始日期和結束日期之間的持續時間必須大於 3 年。
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    function validateDates() {
        const startDate = new Date(document.getElementById('stdate').value);
        const endDate = new Date(document.getElementById('eddate').value);

        // Calculate the difference in time
        const timeDifference = endDate - startDate;

        // Convert time difference to days
        const dayDifference = timeDifference / (1000 * 3600 * 24);

        if (dayDifference <= 1036) {
            // Show the modal
            var myModal = new bootstrap.Modal(document.getElementById('exampleModal'), {
                keyboard: false
            });
            myModal.show();
            return false;
        }

        return true;
    }
</script>

<!-- Bootstrap CSS and JS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
